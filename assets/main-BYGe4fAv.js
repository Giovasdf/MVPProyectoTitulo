import{d as Ue,a as A,o as N,c as Q,r as Ne,b as p,e as v,f,g as c,h as $,w as P,i as Y,t as y,j as R,k as M,l as te,m as xe,F as D,n as J,p as L,v as re,q as G,u as we,s as K,x as j,y as Se,z as V,A as je,B as De,C as Fe,D as Be,E as Me}from"./vue-67McKtzl.js";(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))s(n);new MutationObserver(n=>{for(const o of n)if(o.type==="childList")for(const r of o.addedNodes)r.tagName==="LINK"&&r.rel==="modulepreload"&&s(r)}).observe(document,{childList:!0,subtree:!0});function t(n){const o={};return n.integrity&&(o.integrity=n.integrity),n.referrerPolicy&&(o.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?o.credentials="include":n.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function s(n){if(n.ep)return;n.ep=!0;const o=t(n);fetch(n.href,o)}})();const Ve=/"(?:_|\\u0{2}5[Ff]){2}(?:p|\\u0{2}70)(?:r|\\u0{2}72)(?:o|\\u0{2}6[Ff])(?:t|\\u0{2}74)(?:o|\\u0{2}6[Ff])(?:_|\\u0{2}5[Ff]){2}"\s*:/,We=/"(?:c|\\u0063)(?:o|\\u006[Ff])(?:n|\\u006[Ee])(?:s|\\u0073)(?:t|\\u0074)(?:r|\\u0072)(?:u|\\u0075)(?:c|\\u0063)(?:t|\\u0074)(?:o|\\u006[Ff])(?:r|\\u0072)"\s*:/,ze=/^\s*["[{]|^\s*-?\d{1,16}(\.\d{1,17})?([Ee][+-]?\d+)?\s*$/;function Ke(i,e){if(i==="__proto__"||i==="constructor"&&e&&typeof e=="object"&&"prototype"in e){Ge(i);return}return e}function Ge(i){console.warn(`[destr] Dropping "${i}" key to prevent prototype pollution.`)}function Je(i,e={}){if(typeof i!="string")return i;if(i[0]==='"'&&i[i.length-1]==='"'&&i.indexOf("\\")===-1)return i.slice(1,-1);const t=i.trim();if(t.length<=9)switch(t.toLowerCase()){case"true":return!0;case"false":return!1;case"undefined":return;case"null":return null;case"nan":return Number.NaN;case"infinity":return Number.POSITIVE_INFINITY;case"-infinity":return Number.NEGATIVE_INFINITY}if(!ze.test(i)){if(e.strict)throw new SyntaxError("[destr] Invalid JSON");return i}try{if(Ve.test(i)||We.test(i)){if(e.strict)throw new Error("[destr] Possible prototype pollution");return JSON.parse(i,Ke)}return JSON.parse(i)}catch(s){if(e.strict)throw s;return i}}function He(i,e){if(i==null)return;let t=i;for(let s=0;s<e.length;s++){if(t==null||t[e[s]]==null)return;t=t[e[s]]}return t}function se(i,e,t){if(t.length===0)return e;const s=t[0];return t.length>1&&(e=se(typeof i!="object"||i===null||!Object.prototype.hasOwnProperty.call(i,s)?Number.isInteger(Number(t[1]))?[]:{}:i[s],e,Array.prototype.slice.call(t,1))),Number.isInteger(Number(s))&&Array.isArray(i)?i.slice()[s]:Object.assign({},i,{[s]:e})}function _e(i,e){if(i==null||e.length===0)return i;if(e.length===1){if(i==null)return i;if(Number.isInteger(e[0])&&Array.isArray(i))return Array.prototype.slice.call(i,0).splice(e[0],1);const t={};for(const s in i)t[s]=i[s];return delete t[e[0]],t}if(i[e[0]]==null){if(Number.isInteger(e[0])&&Array.isArray(i))return Array.prototype.concat.call([],i);const t={};for(const s in i)t[s]=i[s];return t}return se(i,_e(i[e[0]],Array.prototype.slice.call(e,1)),[e[0]])}function Ce(i,e){return e.map(t=>t.split(".")).map(t=>[t,He(i,t)]).filter(t=>t[1]!==void 0).reduce((t,s)=>se(t,s[1],s[0]),{})}function Oe(i,e){return e.map(t=>t.split(".")).reduce((t,s)=>_e(t,s),i)}function ae(i,{storage:e,serializer:t,key:s,debug:n,pick:o,omit:r,beforeHydrate:a,afterHydrate:l},u,b=!0){try{b&&(a==null||a(u));const d=e.getItem(s);if(d){const h=t.deserialize(d),_=o?Ce(h,o):h,g=r?Oe(_,r):_;i.$patch(g)}b&&(l==null||l(u))}catch(d){n&&console.error("[pinia-plugin-persistedstate]",d)}}function ce(i,{storage:e,serializer:t,key:s,debug:n,pick:o,omit:r}){try{const a=o?Ce(i,o):i,l=r?Oe(a,r):a,u=t.serialize(l);e.setItem(s,u)}catch(a){n&&console.error("[pinia-plugin-persistedstate]",a)}}function Qe(i,e,t){const{pinia:s,store:n,options:{persist:o=t}}=i;if(!o)return;if(!(n.$id in s.state.value)){const l=s._s.get(n.$id.replace("__hot:",""));l&&Promise.resolve().then(()=>l.$persist());return}const a=(Array.isArray(o)?o:o===!0?[{}]:[o]).map(e);n.$hydrate=({runHooks:l=!0}={})=>{a.forEach(u=>{ae(n,u,i,l)})},n.$persist=()=>{a.forEach(l=>{ce(n.$state,l)})},a.forEach(l=>{ae(n,l,i),n.$subscribe((u,b)=>ce(b,l),{detached:!0})})}function Ye(i={}){return function(e){Qe(e,t=>({key:(i.key?i.key:s=>s)(t.key??e.store.$id),debug:t.debug??i.debug??!1,serializer:t.serializer??i.serializer??{serialize:s=>JSON.stringify(s),deserialize:s=>Je(s)},storage:t.storage??i.storage??window.localStorage,beforeHydrate:t.beforeHydrate,afterHydrate:t.afterHydrate,pick:t.pick,omit:t.omit}),i.auto??!1)}}var Ze=Ye();class E extends Error{constructor(e){var t,s,n,o;super("ClientResponseError"),this.url="",this.status=0,this.response={},this.isAbort=!1,this.originalError=null,Object.setPrototypeOf(this,E.prototype),e!==null&&typeof e=="object"&&(this.url=typeof e.url=="string"?e.url:"",this.status=typeof e.status=="number"?e.status:0,this.isAbort=!!e.isAbort,this.originalError=e.originalError,e.response!==null&&typeof e.response=="object"?this.response=e.response:e.data!==null&&typeof e.data=="object"?this.response=e.data:this.response={}),this.originalError||e instanceof E||(this.originalError=e),typeof DOMException<"u"&&e instanceof DOMException&&(this.isAbort=!0),this.name="ClientResponseError "+this.status,this.message=(t=this.response)==null?void 0:t.message,this.message||(this.isAbort?this.message="The request was autocancelled. You can find more info in https://github.com/pocketbase/js-sdk#auto-cancellation.":(o=(n=(s=this.originalError)==null?void 0:s.cause)==null?void 0:n.message)!=null&&o.includes("ECONNREFUSED ::1")?this.message="Failed to connect to the PocketBase server. Try changing the SDK URL from localhost to 127.0.0.1 (https://github.com/pocketbase/js-sdk/issues/21).":this.message="Something went wrong while processing your request.")}get data(){return this.response}toJSON(){return{...this}}}const H=/^[\u0009\u0020-\u007e\u0080-\u00ff]+$/;function Xe(i,e){const t={};if(typeof i!="string")return t;const s=Object.assign({},{}).decode||et;let n=0;for(;n<i.length;){const o=i.indexOf("=",n);if(o===-1)break;let r=i.indexOf(";",n);if(r===-1)r=i.length;else if(r<o){n=i.lastIndexOf(";",o-1)+1;continue}const a=i.slice(n,o).trim();if(t[a]===void 0){let l=i.slice(o+1,r).trim();l.charCodeAt(0)===34&&(l=l.slice(1,-1));try{t[a]=s(l)}catch{t[a]=l}}n=r+1}return t}function le(i,e,t){const s=Object.assign({},t||{}),n=s.encode||tt;if(!H.test(i))throw new TypeError("argument name is invalid");const o=n(e);if(o&&!H.test(o))throw new TypeError("argument val is invalid");let r=i+"="+o;if(s.maxAge!=null){const a=s.maxAge-0;if(isNaN(a)||!isFinite(a))throw new TypeError("option maxAge is invalid");r+="; Max-Age="+Math.floor(a)}if(s.domain){if(!H.test(s.domain))throw new TypeError("option domain is invalid");r+="; Domain="+s.domain}if(s.path){if(!H.test(s.path))throw new TypeError("option path is invalid");r+="; Path="+s.path}if(s.expires){if(!function(l){return Object.prototype.toString.call(l)==="[object Date]"||l instanceof Date}(s.expires)||isNaN(s.expires.valueOf()))throw new TypeError("option expires is invalid");r+="; Expires="+s.expires.toUTCString()}if(s.httpOnly&&(r+="; HttpOnly"),s.secure&&(r+="; Secure"),s.priority)switch(typeof s.priority=="string"?s.priority.toLowerCase():s.priority){case"low":r+="; Priority=Low";break;case"medium":r+="; Priority=Medium";break;case"high":r+="; Priority=High";break;default:throw new TypeError("option priority is invalid")}if(s.sameSite)switch(typeof s.sameSite=="string"?s.sameSite.toLowerCase():s.sameSite){case!0:r+="; SameSite=Strict";break;case"lax":r+="; SameSite=Lax";break;case"strict":r+="; SameSite=Strict";break;case"none":r+="; SameSite=None";break;default:throw new TypeError("option sameSite is invalid")}return r}function et(i){return i.indexOf("%")!==-1?decodeURIComponent(i):i}function tt(i){return encodeURIComponent(i)}const st=typeof navigator<"u"&&navigator.product==="ReactNative"||typeof global<"u"&&global.HermesInternal;let ke;function W(i){if(i)try{const e=decodeURIComponent(ke(i.split(".")[1]).split("").map(function(t){return"%"+("00"+t.charCodeAt(0).toString(16)).slice(-2)}).join(""));return JSON.parse(e)||{}}catch{}return{}}function Ie(i,e=0){let t=W(i);return!(Object.keys(t).length>0&&(!t.exp||t.exp-e>Date.now()/1e3))}ke=typeof atob!="function"||st?i=>{let e=String(i).replace(/=+$/,"");if(e.length%4==1)throw new Error("'atob' failed: The string to be decoded is not correctly encoded.");for(var t,s,n=0,o=0,r="";s=e.charAt(o++);~s&&(t=n%4?64*t+s:s,n++%4)?r+=String.fromCharCode(255&t>>(-2*n&6)):0)s="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".indexOf(s);return r}:atob;const ue="pb_auth";class ne{constructor(){this.baseToken="",this.baseModel=null,this._onChangeCallbacks=[]}get token(){return this.baseToken}get record(){return this.baseModel}get model(){return this.baseModel}get isValid(){return!Ie(this.token)}get isSuperuser(){var t,s;let e=W(this.token);return e.type=="auth"&&(((t=this.record)==null?void 0:t.collectionName)=="_superusers"||!((s=this.record)!=null&&s.collectionName)&&e.collectionId=="pbc_3142635823")}get isAdmin(){return console.warn("Please replace pb.authStore.isAdmin with pb.authStore.isSuperuser OR simply check the value of pb.authStore.record?.collectionName"),this.isSuperuser}get isAuthRecord(){return console.warn("Please replace pb.authStore.isAuthRecord with !pb.authStore.isSuperuser OR simply check the value of pb.authStore.record?.collectionName"),W(this.token).type=="auth"&&!this.isSuperuser}save(e,t){this.baseToken=e||"",this.baseModel=t||null,this.triggerChange()}clear(){this.baseToken="",this.baseModel=null,this.triggerChange()}loadFromCookie(e,t=ue){const s=Xe(e||"")[t]||"";let n={};try{n=JSON.parse(s),(typeof n===null||typeof n!="object"||Array.isArray(n))&&(n={})}catch{}this.save(n.token||"",n.record||n.model||null)}exportToCookie(e,t=ue){var l,u;const s={secure:!0,sameSite:!0,httpOnly:!0,path:"/"},n=W(this.token);s.expires=n!=null&&n.exp?new Date(1e3*n.exp):new Date("1970-01-01"),e=Object.assign({},s,e);const o={token:this.token,record:this.record?JSON.parse(JSON.stringify(this.record)):null};let r=le(t,JSON.stringify(o),e);const a=typeof Blob<"u"?new Blob([r]).size:r.length;if(o.record&&a>4096){o.record={id:(l=o.record)==null?void 0:l.id,email:(u=o.record)==null?void 0:u.email};const b=["collectionId","collectionName","verified"];for(const d in this.record)b.includes(d)&&(o.record[d]=this.record[d]);r=le(t,JSON.stringify(o),e)}return r}onChange(e,t=!1){return this._onChangeCallbacks.push(e),t&&e(this.token,this.record),()=>{for(let s=this._onChangeCallbacks.length-1;s>=0;s--)if(this._onChangeCallbacks[s]==e)return delete this._onChangeCallbacks[s],void this._onChangeCallbacks.splice(s,1)}}triggerChange(){for(const e of this._onChangeCallbacks)e&&e(this.token,this.record)}}class nt extends ne{constructor(e="pocketbase_auth"){super(),this.storageFallback={},this.storageKey=e,this._bindStorageEvent()}get token(){return(this._storageGet(this.storageKey)||{}).token||""}get record(){const e=this._storageGet(this.storageKey)||{};return e.record||e.model||null}get model(){return this.record}save(e,t){this._storageSet(this.storageKey,{token:e,record:t}),super.save(e,t)}clear(){this._storageRemove(this.storageKey),super.clear()}_storageGet(e){if(typeof window<"u"&&(window!=null&&window.localStorage)){const t=window.localStorage.getItem(e)||"";try{return JSON.parse(t)}catch{return t}}return this.storageFallback[e]}_storageSet(e,t){if(typeof window<"u"&&(window!=null&&window.localStorage)){let s=t;typeof t!="string"&&(s=JSON.stringify(t)),window.localStorage.setItem(e,s)}else this.storageFallback[e]=t}_storageRemove(e){var t;typeof window<"u"&&(window!=null&&window.localStorage)&&((t=window.localStorage)==null||t.removeItem(e)),delete this.storageFallback[e]}_bindStorageEvent(){typeof window<"u"&&(window!=null&&window.localStorage)&&window.addEventListener&&window.addEventListener("storage",e=>{if(e.key!=this.storageKey)return;const t=this._storageGet(this.storageKey)||{};super.save(t.token||"",t.record||t.model||null)})}}class T{constructor(e){this.client=e}}class it extends T{async getAll(e){return e=Object.assign({method:"GET"},e),this.client.send("/api/settings",e)}async update(e,t){return t=Object.assign({method:"PATCH",body:e},t),this.client.send("/api/settings",t)}async testS3(e="storage",t){return t=Object.assign({method:"POST",body:{filesystem:e}},t),this.client.send("/api/settings/test/s3",t).then(()=>!0)}async testEmail(e,t,s,n){return n=Object.assign({method:"POST",body:{email:t,template:s,collection:e}},n),this.client.send("/api/settings/test/email",n).then(()=>!0)}async generateAppleClientSecret(e,t,s,n,o,r){return r=Object.assign({method:"POST",body:{clientId:e,teamId:t,keyId:s,privateKey:n,duration:o}},r),this.client.send("/api/settings/apple/generate-client-secret",r)}}const ot=["requestKey","$cancelKey","$autoCancel","fetch","headers","body","query","params","cache","credentials","headers","integrity","keepalive","method","mode","redirect","referrer","referrerPolicy","signal","window"];function ie(i){if(i){i.query=i.query||{};for(let e in i)ot.includes(e)||(i.query[e]=i[e],delete i[e])}}function Ae(i){const e=[];for(const t in i){const s=encodeURIComponent(t),n=Array.isArray(i[t])?i[t]:[i[t]];for(let o of n)o=rt(o),o!==null&&e.push(s+"="+o)}return e.join("&")}function rt(i){return i==null?null:i instanceof Date?encodeURIComponent(i.toISOString().replace("T"," ")):encodeURIComponent(typeof i=="object"?JSON.stringify(i):i)}class Pe extends T{constructor(){super(...arguments),this.clientId="",this.eventSource=null,this.subscriptions={},this.lastSentSubscriptions=[],this.maxConnectTimeout=15e3,this.reconnectAttempts=0,this.maxReconnectAttempts=1/0,this.predefinedReconnectIntervals=[200,300,500,1e3,1200,1500,2e3],this.pendingConnects=[]}get isConnected(){return!!this.eventSource&&!!this.clientId&&!this.pendingConnects.length}async subscribe(e,t,s){var r;if(!e)throw new Error("topic must be set.");let n=e;if(s){ie(s=Object.assign({},s));const a="options="+encodeURIComponent(JSON.stringify({query:s.query,headers:s.headers}));n+=(n.includes("?")?"&":"?")+a}const o=function(a){const l=a;let u;try{u=JSON.parse(l==null?void 0:l.data)}catch{}t(u||{})};return this.subscriptions[n]||(this.subscriptions[n]=[]),this.subscriptions[n].push(o),this.isConnected?this.subscriptions[n].length===1?await this.submitSubscriptions():(r=this.eventSource)==null||r.addEventListener(n,o):await this.connect(),async()=>this.unsubscribeByTopicAndListener(e,o)}async unsubscribe(e){var s;let t=!1;if(e){const n=this.getSubscriptionsByTopic(e);for(let o in n)if(this.hasSubscriptionListeners(o)){for(let r of this.subscriptions[o])(s=this.eventSource)==null||s.removeEventListener(o,r);delete this.subscriptions[o],t||(t=!0)}}else this.subscriptions={};this.hasSubscriptionListeners()?t&&await this.submitSubscriptions():this.disconnect()}async unsubscribeByPrefix(e){var s;let t=!1;for(let n in this.subscriptions)if((n+"?").startsWith(e)){t=!0;for(let o of this.subscriptions[n])(s=this.eventSource)==null||s.removeEventListener(n,o);delete this.subscriptions[n]}t&&(this.hasSubscriptionListeners()?await this.submitSubscriptions():this.disconnect())}async unsubscribeByTopicAndListener(e,t){var o;let s=!1;const n=this.getSubscriptionsByTopic(e);for(let r in n){if(!Array.isArray(this.subscriptions[r])||!this.subscriptions[r].length)continue;let a=!1;for(let l=this.subscriptions[r].length-1;l>=0;l--)this.subscriptions[r][l]===t&&(a=!0,delete this.subscriptions[r][l],this.subscriptions[r].splice(l,1),(o=this.eventSource)==null||o.removeEventListener(r,t));a&&(this.subscriptions[r].length||delete this.subscriptions[r],s||this.hasSubscriptionListeners(r)||(s=!0))}this.hasSubscriptionListeners()?s&&await this.submitSubscriptions():this.disconnect()}hasSubscriptionListeners(e){var t,s;if(this.subscriptions=this.subscriptions||{},e)return!!((t=this.subscriptions[e])!=null&&t.length);for(let n in this.subscriptions)if((s=this.subscriptions[n])!=null&&s.length)return!0;return!1}async submitSubscriptions(){if(this.clientId)return this.addAllSubscriptionListeners(),this.lastSentSubscriptions=this.getNonEmptySubscriptionKeys(),this.client.send("/api/realtime",{method:"POST",body:{clientId:this.clientId,subscriptions:this.lastSentSubscriptions},requestKey:this.getSubscriptionsCancelKey()}).catch(e=>{if(!(e!=null&&e.isAbort))throw e})}getSubscriptionsCancelKey(){return"realtime_"+this.clientId}getSubscriptionsByTopic(e){const t={};e=e.includes("?")?e:e+"?";for(let s in this.subscriptions)(s+"?").startsWith(e)&&(t[s]=this.subscriptions[s]);return t}getNonEmptySubscriptionKeys(){const e=[];for(let t in this.subscriptions)this.subscriptions[t].length&&e.push(t);return e}addAllSubscriptionListeners(){if(this.eventSource){this.removeAllSubscriptionListeners();for(let e in this.subscriptions)for(let t of this.subscriptions[e])this.eventSource.addEventListener(e,t)}}removeAllSubscriptionListeners(){if(this.eventSource)for(let e in this.subscriptions)for(let t of this.subscriptions[e])this.eventSource.removeEventListener(e,t)}async connect(){if(!(this.reconnectAttempts>0))return new Promise((e,t)=>{this.pendingConnects.push({resolve:e,reject:t}),this.pendingConnects.length>1||this.initConnect()})}initConnect(){this.disconnect(!0),clearTimeout(this.connectTimeoutId),this.connectTimeoutId=setTimeout(()=>{this.connectErrorHandler(new Error("EventSource connect took too long."))},this.maxConnectTimeout),this.eventSource=new EventSource(this.client.buildURL("/api/realtime")),this.eventSource.onerror=e=>{this.connectErrorHandler(new Error("Failed to establish realtime connection."))},this.eventSource.addEventListener("PB_CONNECT",e=>{const t=e;this.clientId=t==null?void 0:t.lastEventId,this.submitSubscriptions().then(async()=>{let s=3;for(;this.hasUnsentSubscriptions()&&s>0;)s--,await this.submitSubscriptions()}).then(()=>{for(let n of this.pendingConnects)n.resolve();this.pendingConnects=[],this.reconnectAttempts=0,clearTimeout(this.reconnectTimeoutId),clearTimeout(this.connectTimeoutId);const s=this.getSubscriptionsByTopic("PB_CONNECT");for(let n in s)for(let o of s[n])o(e)}).catch(s=>{this.clientId="",this.connectErrorHandler(s)})})}hasUnsentSubscriptions(){const e=this.getNonEmptySubscriptionKeys();if(e.length!=this.lastSentSubscriptions.length)return!0;for(const t of e)if(!this.lastSentSubscriptions.includes(t))return!0;return!1}connectErrorHandler(e){if(clearTimeout(this.connectTimeoutId),clearTimeout(this.reconnectTimeoutId),!this.clientId&&!this.reconnectAttempts||this.reconnectAttempts>this.maxReconnectAttempts){for(let s of this.pendingConnects)s.reject(new E(e));return this.pendingConnects=[],void this.disconnect()}this.disconnect(!0);const t=this.predefinedReconnectIntervals[this.reconnectAttempts]||this.predefinedReconnectIntervals[this.predefinedReconnectIntervals.length-1];this.reconnectAttempts++,this.reconnectTimeoutId=setTimeout(()=>{this.initConnect()},t)}disconnect(e=!1){var t;if(this.clientId&&this.onDisconnect&&this.onDisconnect(Object.keys(this.subscriptions)),clearTimeout(this.connectTimeoutId),clearTimeout(this.reconnectTimeoutId),this.removeAllSubscriptionListeners(),this.client.cancelRequest(this.getSubscriptionsCancelKey()),(t=this.eventSource)==null||t.close(),this.eventSource=null,this.clientId="",!e){this.reconnectAttempts=0;for(let s of this.pendingConnects)s.resolve();this.pendingConnects=[]}}}class Ee extends T{decode(e){return e}async getFullList(e,t){if(typeof e=="number")return this._getFullList(e,t);let s=500;return(t=Object.assign({},e,t)).batch&&(s=t.batch,delete t.batch),this._getFullList(s,t)}async getList(e=1,t=30,s){return(s=Object.assign({method:"GET"},s)).query=Object.assign({page:e,perPage:t},s.query),this.client.send(this.baseCrudPath,s).then(n=>{var o;return n.items=((o=n.items)==null?void 0:o.map(r=>this.decode(r)))||[],n})}async getFirstListItem(e,t){return(t=Object.assign({requestKey:"one_by_filter_"+this.baseCrudPath+"_"+e},t)).query=Object.assign({filter:e,skipTotal:1},t.query),this.getList(1,1,t).then(s=>{var n;if(!((n=s==null?void 0:s.items)!=null&&n.length))throw new E({status:404,response:{code:404,message:"The requested resource wasn't found.",data:{}}});return s.items[0]})}async getOne(e,t){if(!e)throw new E({url:this.client.buildURL(this.baseCrudPath+"/"),status:404,response:{code:404,message:"Missing required record id.",data:{}}});return t=Object.assign({method:"GET"},t),this.client.send(this.baseCrudPath+"/"+encodeURIComponent(e),t).then(s=>this.decode(s))}async create(e,t){return t=Object.assign({method:"POST",body:e},t),this.client.send(this.baseCrudPath,t).then(s=>this.decode(s))}async update(e,t,s){return s=Object.assign({method:"PATCH",body:t},s),this.client.send(this.baseCrudPath+"/"+encodeURIComponent(e),s).then(n=>this.decode(n))}async delete(e,t){return t=Object.assign({method:"DELETE"},t),this.client.send(this.baseCrudPath+"/"+encodeURIComponent(e),t).then(()=>!0)}_getFullList(e=500,t){(t=t||{}).query=Object.assign({skipTotal:1},t.query);let s=[],n=async o=>this.getList(o,e||500,t).then(r=>{const a=r.items;return s=s.concat(a),a.length==r.perPage?n(o+1):s});return n(1)}}function U(i,e,t,s){const n=s!==void 0;return n||t!==void 0?n?(console.warn(i),e.body=Object.assign({},e.body,t),e.query=Object.assign({},e.query,s),e):Object.assign(e,t):e}function Z(i){var e;(e=i._resetAutoRefresh)==null||e.call(i)}class at extends Ee{constructor(e,t){super(e),this.collectionIdOrName=t}get baseCrudPath(){return this.baseCollectionPath+"/records"}get baseCollectionPath(){return"/api/collections/"+encodeURIComponent(this.collectionIdOrName)}get isSuperusers(){return this.collectionIdOrName=="_superusers"||this.collectionIdOrName=="_pbc_2773867675"}async subscribe(e,t,s){if(!e)throw new Error("Missing topic.");if(!t)throw new Error("Missing subscription callback.");return this.client.realtime.subscribe(this.collectionIdOrName+"/"+e,t,s)}async unsubscribe(e){return e?this.client.realtime.unsubscribe(this.collectionIdOrName+"/"+e):this.client.realtime.unsubscribeByPrefix(this.collectionIdOrName)}async getFullList(e,t){if(typeof e=="number")return super.getFullList(e,t);const s=Object.assign({},e,t);return super.getFullList(s)}async getList(e=1,t=30,s){return super.getList(e,t,s)}async getFirstListItem(e,t){return super.getFirstListItem(e,t)}async getOne(e,t){return super.getOne(e,t)}async create(e,t){return super.create(e,t)}async update(e,t,s){return super.update(e,t,s).then(n=>{var o,r,a;if(((o=this.client.authStore.record)==null?void 0:o.id)===(n==null?void 0:n.id)&&(((r=this.client.authStore.record)==null?void 0:r.collectionId)===this.collectionIdOrName||((a=this.client.authStore.record)==null?void 0:a.collectionName)===this.collectionIdOrName)){let l=Object.assign({},this.client.authStore.record.expand),u=Object.assign({},this.client.authStore.record,n);l&&(u.expand=Object.assign(l,n.expand)),this.client.authStore.save(this.client.authStore.token,u)}return n})}async delete(e,t){return super.delete(e,t).then(s=>{var n,o,r;return!s||((n=this.client.authStore.record)==null?void 0:n.id)!==e||((o=this.client.authStore.record)==null?void 0:o.collectionId)!==this.collectionIdOrName&&((r=this.client.authStore.record)==null?void 0:r.collectionName)!==this.collectionIdOrName||this.client.authStore.clear(),s})}authResponse(e){const t=this.decode((e==null?void 0:e.record)||{});return this.client.authStore.save(e==null?void 0:e.token,t),Object.assign({},e,{token:(e==null?void 0:e.token)||"",record:t})}async listAuthMethods(e){return e=Object.assign({method:"GET",fields:"mfa,otp,password,oauth2"},e),this.client.send(this.baseCollectionPath+"/auth-methods",e)}async authWithPassword(e,t,s){let n;s=Object.assign({method:"POST",body:{identity:e,password:t}},s),this.isSuperusers&&(n=s.autoRefreshThreshold,delete s.autoRefreshThreshold,s.autoRefresh||Z(this.client));let o=await this.client.send(this.baseCollectionPath+"/auth-with-password",s);return o=this.authResponse(o),n&&this.isSuperusers&&function(a,l,u,b){Z(a);const d=a.beforeSend,h=a.authStore.record,_=a.authStore.onChange((g,S)=>{(!g||(S==null?void 0:S.id)!=(h==null?void 0:h.id)||(S!=null&&S.collectionId||h!=null&&h.collectionId)&&(S==null?void 0:S.collectionId)!=(h==null?void 0:h.collectionId))&&Z(a)});a._resetAutoRefresh=function(){_(),a.beforeSend=d,delete a._resetAutoRefresh},a.beforeSend=async(g,S)=>{var m;const I=a.authStore.token;if((m=S.query)!=null&&m.autoRefresh)return d?d(g,S):{url:g,sendOptions:S};let q=a.authStore.isValid;if(q&&Ie(a.authStore.token,l))try{await u()}catch{q=!1}q||await b();const x=S.headers||{};for(let w in x)if(w.toLowerCase()=="authorization"&&I==x[w]&&a.authStore.token){x[w]=a.authStore.token;break}return S.headers=x,d?d(g,S):{url:g,sendOptions:S}}}(this.client,n,()=>this.authRefresh({autoRefresh:!0}),()=>this.authWithPassword(e,t,Object.assign({autoRefresh:!0},s))),o}async authWithOAuth2Code(e,t,s,n,o,r,a){let l={method:"POST",body:{provider:e,code:t,codeVerifier:s,redirectURL:n,createData:o}};return l=U("This form of authWithOAuth2Code(provider, code, codeVerifier, redirectURL, createData?, body?, query?) is deprecated. Consider replacing it with authWithOAuth2Code(provider, code, codeVerifier, redirectURL, createData?, options?).",l,r,a),this.client.send(this.baseCollectionPath+"/auth-with-oauth2",l).then(u=>this.authResponse(u))}authWithOAuth2(...e){if(e.length>1||typeof(e==null?void 0:e[0])=="string")return console.warn("PocketBase: This form of authWithOAuth2() is deprecated and may get removed in the future. Please replace with authWithOAuth2Code() OR use the authWithOAuth2() realtime form as shown in https://pocketbase.io/docs/authentication/#oauth2-integration."),this.authWithOAuth2Code((e==null?void 0:e[0])||"",(e==null?void 0:e[1])||"",(e==null?void 0:e[2])||"",(e==null?void 0:e[3])||"",(e==null?void 0:e[4])||{},(e==null?void 0:e[5])||{},(e==null?void 0:e[6])||{});const t=(e==null?void 0:e[0])||{};let s=null;t.urlCallback||(s=de(void 0));const n=new Pe(this.client);function o(){s==null||s.close(),n.unsubscribe()}const r={},a=t.requestKey;return a&&(r.requestKey=a),this.listAuthMethods(r).then(l=>{var h;const u=l.oauth2.providers.find(_=>_.name===t.provider);if(!u)throw new E(new Error(`Missing or invalid provider "${t.provider}".`));const b=this.client.buildURL("/api/oauth2-redirect"),d=a?(h=this.client.cancelControllers)==null?void 0:h[a]:void 0;return d&&(d.signal.onabort=()=>{o()}),new Promise(async(_,g)=>{var S;try{await n.subscribe("@oauth2",async m=>{var C;const w=n.clientId;try{if(!m.state||w!==m.state)throw new Error("State parameters don't match.");if(m.error||!m.code)throw new Error("OAuth2 redirect error or missing code: "+m.error);const O=Object.assign({},t);delete O.provider,delete O.scopes,delete O.createData,delete O.urlCallback,(C=d==null?void 0:d.signal)!=null&&C.onabort&&(d.signal.onabort=null);const qe=await this.authWithOAuth2Code(u.name,m.code,u.codeVerifier,b,t.createData,O);_(qe)}catch(O){g(new E(O))}o()});const I={state:n.clientId};(S=t.scopes)!=null&&S.length&&(I.scope=t.scopes.join(" "));const q=this._replaceQueryParams(u.authURL+b,I);await(t.urlCallback||function(m){s?s.location.href=m:s=de(m)})(q)}catch(I){o(),g(new E(I))}})}).catch(l=>{throw o(),l})}async authRefresh(e,t){let s={method:"POST"};return s=U("This form of authRefresh(body?, query?) is deprecated. Consider replacing it with authRefresh(options?).",s,e,t),this.client.send(this.baseCollectionPath+"/auth-refresh",s).then(n=>this.authResponse(n))}async requestPasswordReset(e,t,s){let n={method:"POST",body:{email:e}};return n=U("This form of requestPasswordReset(email, body?, query?) is deprecated. Consider replacing it with requestPasswordReset(email, options?).",n,t,s),this.client.send(this.baseCollectionPath+"/request-password-reset",n).then(()=>!0)}async confirmPasswordReset(e,t,s,n,o){let r={method:"POST",body:{token:e,password:t,passwordConfirm:s}};return r=U("This form of confirmPasswordReset(token, password, passwordConfirm, body?, query?) is deprecated. Consider replacing it with confirmPasswordReset(token, password, passwordConfirm, options?).",r,n,o),this.client.send(this.baseCollectionPath+"/confirm-password-reset",r).then(()=>!0)}async requestVerification(e,t,s){let n={method:"POST",body:{email:e}};return n=U("This form of requestVerification(email, body?, query?) is deprecated. Consider replacing it with requestVerification(email, options?).",n,t,s),this.client.send(this.baseCollectionPath+"/request-verification",n).then(()=>!0)}async confirmVerification(e,t,s){let n={method:"POST",body:{token:e}};return n=U("This form of confirmVerification(token, body?, query?) is deprecated. Consider replacing it with confirmVerification(token, options?).",n,t,s),this.client.send(this.baseCollectionPath+"/confirm-verification",n).then(()=>{const o=W(e),r=this.client.authStore.record;return r&&!r.verified&&r.id===o.id&&r.collectionId===o.collectionId&&(r.verified=!0,this.client.authStore.save(this.client.authStore.token,r)),!0})}async requestEmailChange(e,t,s){let n={method:"POST",body:{newEmail:e}};return n=U("This form of requestEmailChange(newEmail, body?, query?) is deprecated. Consider replacing it with requestEmailChange(newEmail, options?).",n,t,s),this.client.send(this.baseCollectionPath+"/request-email-change",n).then(()=>!0)}async confirmEmailChange(e,t,s,n){let o={method:"POST",body:{token:e,password:t}};return o=U("This form of confirmEmailChange(token, password, body?, query?) is deprecated. Consider replacing it with confirmEmailChange(token, password, options?).",o,s,n),this.client.send(this.baseCollectionPath+"/confirm-email-change",o).then(()=>{const r=W(e),a=this.client.authStore.record;return a&&a.id===r.id&&a.collectionId===r.collectionId&&this.client.authStore.clear(),!0})}async listExternalAuths(e,t){return this.client.collection("_externalAuths").getFullList(Object.assign({},t,{filter:this.client.filter("recordRef = {:id}",{id:e})}))}async unlinkExternalAuth(e,t,s){const n=await this.client.collection("_externalAuths").getFirstListItem(this.client.filter("recordRef = {:recordId} && provider = {:provider}",{recordId:e,provider:t}));return this.client.collection("_externalAuths").delete(n.id,s).then(()=>!0)}async requestOTP(e,t){return t=Object.assign({method:"POST",body:{email:e}},t),this.client.send(this.baseCollectionPath+"/request-otp",t)}async authWithOTP(e,t,s){return s=Object.assign({method:"POST",body:{otpId:e,password:t}},s),this.client.send(this.baseCollectionPath+"/auth-with-otp",s).then(n=>this.authResponse(n))}async impersonate(e,t,s){(s=Object.assign({method:"POST",body:{duration:t}},s)).headers=s.headers||{},s.headers.Authorization||(s.headers.Authorization=this.client.authStore.token);const n=new F(this.client.baseURL,new ne,this.client.lang),o=await n.send(this.baseCollectionPath+"/impersonate/"+encodeURIComponent(e),s);return n.authStore.save(o==null?void 0:o.token,this.decode((o==null?void 0:o.record)||{})),n}_replaceQueryParams(e,t={}){let s=e,n="";e.indexOf("?")>=0&&(s=e.substring(0,e.indexOf("?")),n=e.substring(e.indexOf("?")+1));const o={},r=n.split("&");for(const a of r){if(a=="")continue;const l=a.split("=");o[decodeURIComponent(l[0].replace(/\+/g," "))]=decodeURIComponent((l[1]||"").replace(/\+/g," "))}for(let a in t)t.hasOwnProperty(a)&&(t[a]==null?delete o[a]:o[a]=t[a]);n="";for(let a in o)o.hasOwnProperty(a)&&(n!=""&&(n+="&"),n+=encodeURIComponent(a.replace(/%20/g,"+"))+"="+encodeURIComponent(o[a].replace(/%20/g,"+")));return n!=""?s+"?"+n:s}}function de(i){if(typeof window>"u"||!(window!=null&&window.open))throw new E(new Error("Not in a browser context - please pass a custom urlCallback function."));let e=1024,t=768,s=window.innerWidth,n=window.innerHeight;e=e>s?s:e,t=t>n?n:t;let o=s/2-e/2,r=n/2-t/2;return window.open(i,"popup_window","width="+e+",height="+t+",top="+r+",left="+o+",resizable,menubar=no")}class ct extends Ee{get baseCrudPath(){return"/api/collections"}async import(e,t=!1,s){return s=Object.assign({method:"PUT",body:{collections:e,deleteMissing:t}},s),this.client.send(this.baseCrudPath+"/import",s).then(()=>!0)}async getScaffolds(e){return e=Object.assign({method:"GET"},e),this.client.send(this.baseCrudPath+"/meta/scaffolds",e)}async truncate(e,t){return t=Object.assign({method:"DELETE"},t),this.client.send(this.baseCrudPath+"/"+encodeURIComponent(e)+"/truncate",t).then(()=>!0)}}class lt extends T{async getList(e=1,t=30,s){return(s=Object.assign({method:"GET"},s)).query=Object.assign({page:e,perPage:t},s.query),this.client.send("/api/logs",s)}async getOne(e,t){if(!e)throw new E({url:this.client.buildURL("/api/logs/"),status:404,response:{code:404,message:"Missing required log id.",data:{}}});return t=Object.assign({method:"GET"},t),this.client.send("/api/logs/"+encodeURIComponent(e),t)}async getStats(e){return e=Object.assign({method:"GET"},e),this.client.send("/api/logs/stats",e)}}class ut extends T{async check(e){return e=Object.assign({method:"GET"},e),this.client.send("/api/health",e)}}class dt extends T{getUrl(e,t,s={}){return console.warn("Please replace pb.files.getUrl() with pb.files.getURL()"),this.getURL(e,t,s)}getURL(e,t,s={}){if(!t||!(e!=null&&e.id)||!(e!=null&&e.collectionId)&&!(e!=null&&e.collectionName))return"";const n=[];n.push("api"),n.push("files"),n.push(encodeURIComponent(e.collectionId||e.collectionName)),n.push(encodeURIComponent(e.id)),n.push(encodeURIComponent(t));let o=this.client.buildURL(n.join("/"));if(Object.keys(s).length){s.download===!1&&delete s.download;const r=new URLSearchParams(s);o+=(o.includes("?")?"&":"?")+r}return o}async getToken(e){return e=Object.assign({method:"POST"},e),this.client.send("/api/files/token",e).then(t=>(t==null?void 0:t.token)||"")}}class ht extends T{async getFullList(e){return e=Object.assign({method:"GET"},e),this.client.send("/api/backups",e)}async create(e,t){return t=Object.assign({method:"POST",body:{name:e}},t),this.client.send("/api/backups",t).then(()=>!0)}async upload(e,t){return t=Object.assign({method:"POST",body:e},t),this.client.send("/api/backups/upload",t).then(()=>!0)}async delete(e,t){return t=Object.assign({method:"DELETE"},t),this.client.send(`/api/backups/${encodeURIComponent(e)}`,t).then(()=>!0)}async restore(e,t){return t=Object.assign({method:"POST"},t),this.client.send(`/api/backups/${encodeURIComponent(e)}/restore`,t).then(()=>!0)}getDownloadUrl(e,t){return console.warn("Please replace pb.backups.getDownloadUrl() with pb.backups.getDownloadURL()"),this.getDownloadURL(e,t)}getDownloadURL(e,t){return this.client.buildURL(`/api/backups/${encodeURIComponent(t)}?token=${encodeURIComponent(e)}`)}}class pt extends T{async getFullList(e){return e=Object.assign({method:"GET"},e),this.client.send("/api/crons",e)}async run(e,t){return t=Object.assign({method:"POST"},t),this.client.send(`/api/crons/${encodeURIComponent(e)}`,t).then(()=>!0)}}function X(i){return typeof Blob<"u"&&i instanceof Blob||typeof File<"u"&&i instanceof File||i!==null&&typeof i=="object"&&i.uri&&(typeof navigator<"u"&&navigator.product==="ReactNative"||typeof global<"u"&&global.HermesInternal)}function ee(i){return i&&(i.constructor.name==="FormData"||typeof FormData<"u"&&i instanceof FormData)}function he(i){for(const e in i){const t=Array.isArray(i[e])?i[e]:[i[e]];for(const s of t)if(X(s))return!0}return!1}const ft=/^[\-\.\d]+$/;function pe(i){if(typeof i!="string")return i;if(i=="true")return!0;if(i=="false")return!1;if((i[0]==="-"||i[0]>="0"&&i[0]<="9")&&ft.test(i)){let e=+i;if(""+e===i)return e}return i}class mt extends T{constructor(){super(...arguments),this.requests=[],this.subs={}}collection(e){return this.subs[e]||(this.subs[e]=new bt(this.requests,e)),this.subs[e]}async send(e){const t=new FormData,s=[];for(let n=0;n<this.requests.length;n++){const o=this.requests[n];if(s.push({method:o.method,url:o.url,headers:o.headers,body:o.json}),o.files)for(let r in o.files){const a=o.files[r]||[];for(let l of a)t.append("requests."+n+"."+r,l)}}return t.append("@jsonPayload",JSON.stringify({requests:s})),e=Object.assign({method:"POST",body:t},e),this.client.send("/api/batch",e)}}class bt{constructor(e,t){this.requests=[],this.requests=e,this.collectionIdOrName=t}upsert(e,t){t=Object.assign({body:e||{}},t);const s={method:"PUT",url:"/api/collections/"+encodeURIComponent(this.collectionIdOrName)+"/records"};this.prepareRequest(s,t),this.requests.push(s)}create(e,t){t=Object.assign({body:e||{}},t);const s={method:"POST",url:"/api/collections/"+encodeURIComponent(this.collectionIdOrName)+"/records"};this.prepareRequest(s,t),this.requests.push(s)}update(e,t,s){s=Object.assign({body:t||{}},s);const n={method:"PATCH",url:"/api/collections/"+encodeURIComponent(this.collectionIdOrName)+"/records/"+encodeURIComponent(e)};this.prepareRequest(n,s),this.requests.push(n)}delete(e,t){t=Object.assign({},t);const s={method:"DELETE",url:"/api/collections/"+encodeURIComponent(this.collectionIdOrName)+"/records/"+encodeURIComponent(e)};this.prepareRequest(s,t),this.requests.push(s)}prepareRequest(e,t){if(ie(t),e.headers=t.headers,e.json={},e.files={},t.query!==void 0){const n=Ae(t.query);n&&(e.url+=(e.url.includes("?")?"&":"?")+n)}let s=t.body;ee(s)&&(s=function(o){let r={};return o.forEach((a,l)=>{if(l==="@jsonPayload"&&typeof a=="string")try{let u=JSON.parse(a);Object.assign(r,u)}catch(u){console.warn("@jsonPayload error:",u)}else r[l]!==void 0?(Array.isArray(r[l])||(r[l]=[r[l]]),r[l].push(pe(a))):r[l]=pe(a)}),r}(s));for(const n in s){const o=s[n];if(X(o))e.files[n]=e.files[n]||[],e.files[n].push(o);else if(Array.isArray(o)){const r=[],a=[];for(const l of o)X(l)?r.push(l):a.push(l);if(r.length>0&&r.length==o.length){e.files[n]=e.files[n]||[];for(let l of r)e.files[n].push(l)}else if(e.json[n]=a,r.length>0){let l=n;n.startsWith("+")||n.endsWith("+")||(l+="+"),e.files[l]=e.files[l]||[];for(let u of r)e.files[l].push(u)}}else e.json[n]=o}}}class F{get baseUrl(){return this.baseURL}set baseUrl(e){this.baseURL=e}constructor(e="/",t,s="en-US"){this.cancelControllers={},this.recordServices={},this.enableAutoCancellation=!0,this.baseURL=e,this.lang=s,t?this.authStore=t:typeof window<"u"&&window.Deno?this.authStore=new ne:this.authStore=new nt,this.collections=new ct(this),this.files=new dt(this),this.logs=new lt(this),this.settings=new it(this),this.realtime=new Pe(this),this.health=new ut(this),this.backups=new ht(this),this.crons=new pt(this)}get admins(){return this.collection("_superusers")}createBatch(){return new mt(this)}collection(e){return this.recordServices[e]||(this.recordServices[e]=new at(this,e)),this.recordServices[e]}autoCancellation(e){return this.enableAutoCancellation=!!e,this}cancelRequest(e){return this.cancelControllers[e]&&(this.cancelControllers[e].abort(),delete this.cancelControllers[e]),this}cancelAllRequests(){for(let e in this.cancelControllers)this.cancelControllers[e].abort();return this.cancelControllers={},this}filter(e,t){if(!t)return e;for(let s in t){let n=t[s];switch(typeof n){case"boolean":case"number":n=""+n;break;case"string":n="'"+n.replace(/'/g,"\\'")+"'";break;default:n=n===null?"null":n instanceof Date?"'"+n.toISOString().replace("T"," ")+"'":"'"+JSON.stringify(n).replace(/'/g,"\\'")+"'"}e=e.replaceAll("{:"+s+"}",n)}return e}getFileUrl(e,t,s={}){return console.warn("Please replace pb.getFileUrl() with pb.files.getURL()"),this.files.getURL(e,t,s)}buildUrl(e){return console.warn("Please replace pb.buildUrl() with pb.buildURL()"),this.buildURL(e)}buildURL(e){var s;let t=this.baseURL;return typeof window>"u"||!window.location||t.startsWith("https://")||t.startsWith("http://")||(t=(s=window.location.origin)!=null&&s.endsWith("/")?window.location.origin.substring(0,window.location.origin.length-1):window.location.origin||"",this.baseURL.startsWith("/")||(t+=window.location.pathname||"/",t+=t.endsWith("/")?"":"/"),t+=this.baseURL),e&&(t+=t.endsWith("/")?"":"/",t+=e.startsWith("/")?e.substring(1):e),t}async send(e,t){t=this.initSendOptions(e,t);let s=this.buildURL(e);if(this.beforeSend){const n=Object.assign({},await this.beforeSend(s,t));n.url!==void 0||n.options!==void 0?(s=n.url||s,t=n.options||t):Object.keys(n).length&&(t=n,console!=null&&console.warn&&console.warn("Deprecated format of beforeSend return: please use `return { url, options }`, instead of `return options`."))}if(t.query!==void 0){const n=Ae(t.query);n&&(s+=(s.includes("?")?"&":"?")+n),delete t.query}return this.getHeader(t.headers,"Content-Type")=="application/json"&&t.body&&typeof t.body!="string"&&(t.body=JSON.stringify(t.body)),(t.fetch||fetch)(s,t).then(async n=>{let o={};try{o=await n.json()}catch{}if(this.afterSend&&(o=await this.afterSend(n,o,t)),n.status>=400)throw new E({url:n.url,status:n.status,data:o});return o}).catch(n=>{throw new E(n)})}initSendOptions(e,t){if((t=Object.assign({method:"GET"},t)).body=function(n){if(typeof FormData>"u"||n===void 0||typeof n!="object"||n===null||ee(n)||!he(n))return n;const o=new FormData;for(const r in n){const a=n[r];if(typeof a!="object"||he({data:a})){const l=Array.isArray(a)?a:[a];for(let u of l)o.append(r,u)}else{let l={};l[r]=a,o.append("@jsonPayload",JSON.stringify(l))}}return o}(t.body),ie(t),t.query=Object.assign({},t.params,t.query),t.requestKey===void 0&&(t.$autoCancel===!1||t.query.$autoCancel===!1?t.requestKey=null:(t.$cancelKey||t.query.$cancelKey)&&(t.requestKey=t.$cancelKey||t.query.$cancelKey)),delete t.$autoCancel,delete t.query.$autoCancel,delete t.$cancelKey,delete t.query.$cancelKey,this.getHeader(t.headers,"Content-Type")!==null||ee(t.body)||(t.headers=Object.assign({},t.headers,{"Content-Type":"application/json"})),this.getHeader(t.headers,"Accept-Language")===null&&(t.headers=Object.assign({},t.headers,{"Accept-Language":this.lang})),this.authStore.token&&this.getHeader(t.headers,"Authorization")===null&&(t.headers=Object.assign({},t.headers,{Authorization:this.authStore.token})),this.enableAutoCancellation&&t.requestKey!==null){const s=t.requestKey||(t.method||"GET")+e;delete t.requestKey,this.cancelRequest(s);const n=new AbortController;this.cancelControllers[s]=n,t.signal=n.signal}return t}getHeader(e,t){e=e||{},t=t.toLowerCase();for(let s in e)if(s.toLowerCase()==t)return e[s];return null}}const gt="https://database-mvp-production.up.railway.app",z=new F(gt);async function vt(i,e){try{return await z.collection("users").authWithPassword(i,e,{expand:"sucursal_id"})}catch(t){throw console.error("Error de autenticación:",t),t}}function fe(){return z.authStore.isValid}function me(){return z.authStore.model}function yt(){z.authStore.clear()}const B=Ue("auth",{state:()=>({user:null,isAuthenticated:!1,RolUsuario:null,sucursalId:null,loading:!1,error:null}),getters:{isAdmin(){return this.RolUsuario==="admin"},currentSucursalId(){return this.sucursalId},sucursalNombre(){var i,e,t;return((t=(e=(i=this.user)==null?void 0:i.expand)==null?void 0:e.sucursal_id)==null?void 0:t.nombre)||null}},actions:{async login(i,e){this.loading=!0,this.error=null;try{const t=await vt(i,e);return this.isAuthenticated=fe(),this.user=me(),this.updateUserData(),t}catch(t){throw console.error("Login error:",t),this.error=t instanceof Error?t.message:"Credenciales incorrectas",t}finally{this.loading=!1}},async checkAuth(){try{return this.isAuthenticated=fe(),this.isAuthenticated&&(this.user=me(),this.updateUserData()),this.isAuthenticated}catch(i){return console.error("Auth check error:",i),this.isAuthenticated=!1,!1}},updateUserData(){var i,e;if(!this.user){this.RolUsuario=null,this.sucursalId=null;return}this.RolUsuario=this.user.rol||null,this.sucursalId=this.user.sucursal_id||((e=(i=this.user.expand)==null?void 0:i.sucursal_id)==null?void 0:e.id)||null},async logout(){try{await yt(),this.$reset()}catch(i){throw console.error("Logout error:",i),i}}},persist:!0}),wt=Object.freeze(Object.defineProperty({__proto__:null,useAuthStore:B},Symbol.toStringTag,{value:"Module"})),St=A({__name:"App",setup(i){const e=B();return N(()=>{e.checkAuth()}),(t,s)=>{const n=Ne("RouterView");return p(),Q(n)}}}),k=(i,e)=>{const t=i.__vccOpts||i;for(const[s,n]of e)t[s]=n;return t},_t=k(St,[["__scopeId","data-v-b456b350"]]),Ct="modulepreload",Ot=function(i){return"/"+i},be={},kt=function(e,t,s){let n=Promise.resolve();if(t&&t.length>0){document.getElementsByTagName("link");const r=document.querySelector("meta[property=csp-nonce]"),a=(r==null?void 0:r.nonce)||(r==null?void 0:r.getAttribute("nonce"));n=Promise.allSettled(t.map(l=>{if(l=Ot(l),l in be)return;be[l]=!0;const u=l.endsWith(".css"),b=u?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${l}"]${b}`))return;const d=document.createElement("link");if(d.rel=u?"stylesheet":Ct,u||(d.as="script"),d.crossOrigin="",d.href=l,a&&d.setAttribute("nonce",a),document.head.appendChild(d),u)return new Promise((h,_)=>{d.addEventListener("load",h),d.addEventListener("error",()=>_(new Error(`Unable to preload CSS for ${l}`)))})}))}function o(r){const a=new Event("vite:preloadError",{cancelable:!0});if(a.payload=r,window.dispatchEvent(a),!a.defaultPrevented)throw r}return n.then(r=>{for(const a of r||[])a.status==="rejected"&&o(a.reason);return e().catch(o)})},It="/assets/LogoMediBot2-C9PZj44Q.png",At={class:"landing-navbar"},Pt={class:"navbar-container"},Et={class:"navbar-links desktop"},$t={key:0,class:"mobile-menu mobile"},Rt=A({__name:"LandingNavbar",setup(i){const e=v(!1),t=()=>{e.value=!e.value},s=o=>{const r=document.getElementById(o);r&&r.scrollIntoView({behavior:"smooth"})},n=o=>{s(o),e.value=!1};return(o,r)=>(p(),f("nav",At,[c("div",Pt,[r[11]||(r[11]=c("a",{href:"/",class:"navbar-brand"},[c("img",{src:It,alt:"Logo MediBot",class:"brand-logo"})],-1)),c("ul",Et,[c("li",null,[c("a",{href:"#hero",onClick:r[0]||(r[0]=P(a=>s("hero"),["prevent"]))},"Inicio")]),c("li",null,[c("a",{href:"#why-us",onClick:r[1]||(r[1]=P(a=>s("why-us"),["prevent"]))},"¿Por qué elegirnos?")]),c("li",null,[c("a",{href:"#features-section",onClick:r[2]||(r[2]=P(a=>s("features-section"),["prevent"]))},"Ventajas")]),c("li",null,[c("a",{href:"#how-works",onClick:r[3]||(r[3]=P(a=>s("how-works"),["prevent"]))},"¿Cómo funciona?")]),c("li",null,[c("a",{href:"#contact",onClick:r[4]||(r[4]=P(a=>s("contact"),["prevent"]))},"Contacto")])]),r[12]||(r[12]=c("a",{href:"/login",class:"login-button desktop"},"Iniciar sesión",-1)),c("button",{class:"hamburger mobile",onClick:t},r[10]||(r[10]=[c("span",{class:"hamburger-icon"},null,-1)]))]),e.value?(p(),f("div",$t,[c("ul",null,[c("li",null,[c("a",{href:"#hero",onClick:r[5]||(r[5]=P(a=>n("hero"),["prevent"]))},"Inicio")]),c("li",null,[c("a",{href:"#why-us",onClick:r[6]||(r[6]=P(a=>n("why-us"),["prevent"]))},"¿Por qué elegirnos?")]),c("li",null,[c("a",{href:"#features-section",onClick:r[7]||(r[7]=P(a=>n("features-section"),["prevent"]))},"Ventajas")]),c("li",null,[c("a",{href:"#how-works",onClick:r[8]||(r[8]=P(a=>n("how-works"),["prevent"]))},"¿Cómo funciona?")]),c("li",null,[c("a",{href:"#contact",onClick:r[9]||(r[9]=P(a=>n("contact"),["prevent"]))},"Contacto")]),c("li",null,[c("a",{href:"/login",class:"mobile-login",onClick:t},"Iniciar sesión")])])])):$("",!0)]))}}),$e=k(Rt,[["__scopeId","data-v-f273e6fb"]]),Lt={},Tt={id:"hero",class:"hero-section"};function qt(i,e){return p(),f("section",Tt,e[0]||(e[0]=[Y('<div class="overlay" data-v-f98c3dbd></div><div class="hero-content" data-v-f98c3dbd><h1 class="hero-title animate-pulse-once" data-v-f98c3dbd>Automatiza tu farmacia con MediBot</h1><p class="hero-subtitle animate-pulse-once" data-v-f98c3dbd>Recibe pedidos por WhatsApp, usa inteligencia artificial y gestiona todo desde un solo lugar.</p><a href="#contact" class="btn-primary" data-v-f98c3dbd>Solicita una demo</a></div>',2)]))}const Ut=k(Lt,[["render",qt],["__scopeId","data-v-f98c3dbd"]]),Nt={},xt={id:"features-section",class:"features-section"};function jt(i,e){return p(),f("section",xt,e[0]||(e[0]=[c("div",{class:"features-overlay"},null,-1),c("div",{class:"features-content"},[c("h2",null,"¿Qué puede hacer MediBot?"),c("ul",{class:"features-list"},[c("li",null,"🤖 Atención automatizada por WhatsApp"),c("li",null,"📦 Gestión de pedidos con IA"),c("li",null,"📊 Dashboard en tiempo real"),c("li",null,"🔐 Seguro, privado y fácil de usar")])],-1)]))}const Dt=k(Nt,[["render",jt],["__scopeId","data-v-91fcc674"]]),Ft={id:"why-us",class:"porque-section"},Bt=A({__name:"WhyUs",setup(i){return(e,t)=>(p(),f("section",Ft,t[0]||(t[0]=[Y('<h2 class="section-title" data-v-c47fa678>¿Por qué elegir MediBot?</h2><div class="icon-grid" data-v-c47fa678><div class="icon-box" data-v-c47fa678><div class="icon-circle" data-v-c47fa678><i class="fas fa-robot" data-v-c47fa678></i></div><p data-v-c47fa678>Automatización Inteligente</p></div><div class="icon-box" data-v-c47fa678><div class="icon-circle" data-v-c47fa678><i class="fas fa-shield-alt" data-v-c47fa678></i></div><p data-v-c47fa678>Seguridad y Privacidad</p></div><div class="icon-box" data-v-c47fa678><div class="icon-circle" data-v-c47fa678><i class="fas fa-headset" data-v-c47fa678></i></div><p data-v-c47fa678>Soporte Personalizado</p></div><div class="icon-box" data-v-c47fa678><div class="icon-circle" data-v-c47fa678><i class="fas fa-chart-line" data-v-c47fa678></i></div><p data-v-c47fa678>Análisis en Tiempo Real</p></div></div>',2)])))}}),Mt=k(Bt,[["__scopeId","data-v-c47fa678"]]),Vt={id:"contact",class:"section-container"},Wt={class:"contact-content"},zt=A({__name:"ContactSection",setup(i){const e=()=>{alert("Mensaje enviado. Pronto te contactaremos.")};return(t,s)=>(p(),f("section",Vt,[s[2]||(s[2]=c("div",{class:"overlay"},null,-1)),c("div",Wt,[s[1]||(s[1]=c("h2",{class:"section-title"},"Contáctanos",-1)),c("form",{class:"contact-form",onSubmit:P(e,["prevent"])},s[0]||(s[0]=[c("input",{type:"text",placeholder:"Tu nombre",required:""},null,-1),c("input",{type:"email",placeholder:"Tu correo electrónico",required:""},null,-1),c("textarea",{rows:"4",placeholder:"Escribe tu mensaje...",required:""},null,-1),c("button",{type:"submit"},"Enviar mensaje",-1)]),32)])]))}}),Kt=k(zt,[["__scopeId","data-v-cd39d163"]]),Gt={},Jt={id:"how-works",class:"section-container dark"};function Ht(i,e){return p(),f("section",Jt,e[0]||(e[0]=[Y('<h2 class="section-title" data-v-70ff8e15>¿Cómo funciona MediBot?</h2><div class="pasos-grid" data-v-70ff8e15><div class="paso" data-v-70ff8e15><span class="numero" data-v-70ff8e15>1</span><p data-v-70ff8e15>El cliente escribe por WhatsApp.</p></div><div class="paso" data-v-70ff8e15><span class="numero" data-v-70ff8e15>2</span><p data-v-70ff8e15>MediBot interpreta el pedido con IA.</p></div><div class="paso" data-v-70ff8e15><span class="numero" data-v-70ff8e15>3</span><p data-v-70ff8e15>El pedido se guarda automáticamente.</p></div><div class="paso" data-v-70ff8e15><span class="numero" data-v-70ff8e15>4</span><p data-v-70ff8e15>La farmacia confirma y gestiona el stock.</p></div></div>',2)]))}const Qt=k(Gt,[["render",Ht],["__scopeId","data-v-70ff8e15"]]),Yt={class:"landing-footer"},Zt={class:"footer-container"},Xt={class:"footer-copy"},es=A({__name:"LandingFooter",setup(i){return(e,t)=>(p(),f("footer",Yt,[c("div",Zt,[t[0]||(t[0]=Y('<div class="footer-brand" data-v-3a462e16> 🤖 <span class="brand-text" data-v-3a462e16>MediBot</span></div><div class="footer-links" data-v-3a462e16><a href="#features" data-v-3a462e16>Características</a><a href="#como-funciona" data-v-3a462e16>Cómo funciona</a><a href="#contact" data-v-3a462e16>Contacto</a></div>',2)),c("div",Xt," © "+y(new Date().getFullYear())+" MediBot. Todos los derechos reservados. ",1)])]))}}),Re=k(es,[["__scopeId","data-v-3a462e16"]]),ts={class:"home-view"},ss=A({__name:"HomeView",setup(i){return(e,t)=>(p(),f("div",ts,[R($e),R(Ut),R(Mt),R(Dt),R(Qt),R(Kt),R(Re)]))}}),ns=k(ss,[["__scopeId","data-v-ced9ce87"]]),is={},os={class:"navbar",role:"banner"},rs={class:"navbar-container"};function as(i,e){return p(),f("nav",os,[c("div",rs,[c("button",{class:"navbar-toggler",onClick:e[0]||(e[0]=t=>i.$emit("toggle-sidebar")),"aria-label":"Abrir o cerrar menú"},e[1]||(e[1]=[c("i",{class:"fas fa-bars"},null,-1)])),e[2]||(e[2]=c("div",{class:"navbar-brand","aria-label":"Inicio"},[c("span",{class:"brand-icon"},"💊"),c("span",{class:"brand-text"},"Farmacia Dashboard")],-1))])])}const cs=k(is,[["render",as],["__scopeId","data-v-b9687e6d"]]),ls={class:"sidebar-menu"},us={key:0,class:"menu-header"},ds={class:"menu-nav"},hs=["onClick","aria-label"],ps={key:0,class:"menu-tooltip"},fs={class:"menu-text"},ms={key:0,class:"menu-tooltip"},bs=A({__name:"SideBar",props:{visible:{type:Boolean},currentSection:{}},emits:["update:visible","update:currentSection"],setup(i,{emit:e}){const t=i,s=e,n=we(),o=v(window.innerWidth<768),r=v(t.currentSection),a=B(),l=[{section:"dashboard",label:"Dashboard",icon:"fas fa-chart-line",requiresAdmin:!1},{section:"pedidos",label:"Pedidos",icon:"fas fa-notes-medical",requiresAdmin:!1},{section:"sucursales",label:"Sucursales",icon:"fas fa-store-alt",requiresAdmin:!0},{section:"usuarios",label:"Usuarios",icon:"fas fa-users-cog",requiresAdmin:!0},{section:"configuracion",label:"Configuración",icon:"fas fa-cog",requiresAdmin:!0}],u=M(()=>l.filter(g=>g.requiresAdmin?a.RolUsuario==="admin":!0)),b=()=>{o.value=window.innerWidth<768,o.value&&s("update:visible",!1)};N(()=>{window.addEventListener("resize",b)}),te(()=>{window.removeEventListener("resize",b)}),xe(()=>t.currentSection,g=>r.value=g);const d=g=>{r.value=g,s("update:currentSection",g),o.value&&h()},h=()=>{s("update:visible",!1)},_=async()=>{try{a.logout(),n.push("/login"),o.value&&h()}catch(g){console.error("Error al cerrar sesión:",g)}};return(g,S)=>(p(),f(D,null,[c("div",{class:G(["sidebar",{"sidebar-collapsed":!g.visible&&!o.value,"sidebar-hidden":o.value&&!g.visible}]),role:"navigation","aria-label":"Menú de navegación"},[c("div",ls,[g.visible||o.value?(p(),f("div",us,"Menú")):$("",!0),c("nav",ds,[(p(!0),f(D,null,J(u.value,I=>(p(),f("button",{key:I.section,class:G(["menu-item",{active:r.value===I.section}]),onClick:q=>d(I.section),"aria-label":I.label},[c("i",{class:G([I.icon,"menu-icon"])},null,2),L(c("span",{class:"menu-text"},y(I.label),513),[[re,g.visible]]),g.visible?$("",!0):(p(),f("span",ps,y(I.label),1))],10,hs))),128)),c("button",{class:"menu-item logout-item",onClick:_,"aria-label":"Cerrar sesión"},[S[0]||(S[0]=c("i",{class:"fas fa-sign-out-alt menu-icon"},null,-1)),L(c("span",fs,"Cerrar sesión",512),[[re,g.visible]]),g.visible?$("",!0):(p(),f("span",ms,"Cerrar sesión"))])])])],2),o.value&&g.visible?(p(),f("div",{key:0,class:"sidebar-overlay",onClick:h})):$("",!0)],64))}}),gs=k(bs,[["__scopeId","data-v-a15782c7"]]),vs={class:"dashboard-panel"},ys={class:"kpi-container"},ws={class:"kpi-card"},Ss={class:"kpi-card"},_s={class:"kpi-card"},Cs={key:0,class:"kpi-card"},Os={key:0,class:"error-msg"},ks=A({__name:"Dashboard",setup(i){const e=B(),t=v(0),s=v(0),n=v(0),o=v(0),r=v(""),a=async()=>{var l,u,b;try{const d=((l=e.user)==null?void 0:l.rol)==="admin"?"":`sucursal_id = "${(u=e.user)==null?void 0:u.sucursal_id}"`,h=await z.collection("pedidos").getFullList({sort:"-created",filter:d});if(t.value=h.length,s.value=h.filter(_=>_.estado==="pendiente").length,n.value=h.filter(_=>_.estado==="entregado").length,((b=e.user)==null?void 0:b.rol)==="admin"){const _=await z.collection("sucursales").getFullList();o.value=_.length}}catch(d){console.error("Error al cargar KPIs:",d),r.value="No se pudo cargar el panel"}};return N(async()=>{try{await e.checkAuth(),await a()}catch(l){r.value="No se pudo verificar autenticación",console.error(l)}}),(l,u)=>{var b;return p(),f("div",vs,[u[4]||(u[4]=c("h2",null,"Bienvenido a MediBot",-1)),c("div",ys,[c("div",ws,[u[0]||(u[0]=c("h3",null,"Total Pedidos",-1)),c("p",null,y(t.value),1)]),c("div",Ss,[u[1]||(u[1]=c("h3",null,"Pendientes",-1)),c("p",null,y(s.value),1)]),c("div",_s,[u[2]||(u[2]=c("h3",null,"Entregados",-1)),c("p",null,y(n.value),1)]),((b=K(e).user)==null?void 0:b.rol)==="admin"?(p(),f("div",Cs,[u[3]||(u[3]=c("h3",null,"Sucursales Activas",-1)),c("p",null,y(o.value),1)])):$("",!0)]),r.value?(p(),f("p",Os,y(r.value),1)):$("",!0)])}}}),ge=k(ks,[["__scopeId","data-v-fe1353cb"]]),Is={class:"modal-content"},As={key:0},Ps={key:1},Es=A({__name:"PedidoDetalleModal",props:{pedido:{}},setup(i){const e=t=>new Date(t).toLocaleDateString("es-CL",{day:"2-digit",month:"2-digit",year:"numeric"});return(t,s)=>{var n,o,r,a;return p(),f("div",{class:"modal-overlay",onClick:s[1]||(s[1]=P(l=>t.$emit("cerrar"),["self"]))},[c("div",Is,[s[6]||(s[6]=c("h3",null,"Detalle del Pedido",-1)),c("p",null,[s[2]||(s[2]=c("strong",null,"Cliente:",-1)),j(" "+y((n=t.pedido)==null?void 0:n.cliente),1)]),c("p",null,[s[3]||(s[3]=c("strong",null,"Fecha:",-1)),j(" "+y(e(((o=t.pedido)==null?void 0:o.fecha)||"")),1)]),c("p",null,[s[4]||(s[4]=c("strong",null,"Productos:",-1)),j(" "+y((r=t.pedido)==null?void 0:r.items.length),1)]),c("ul",null,[(p(!0),f(D,null,J((a=t.pedido)==null?void 0:a.items,(l,u)=>(p(),f("li",{key:u},[j(y(l.cantidad)+"x "+y(l.producto)+" ",1),l.dosis?(p(),f("span",As,"("+y(l.dosis)+")",1)):$("",!0),l.requiereReceta?(p(),f("span",Ps,s[5]||(s[5]=[j(" - "),c("strong",null,"Requiere receta",-1)]))):$("",!0)]))),128))]),c("button",{class:"btn-detalle",onClick:s[0]||(s[0]=l=>t.$emit("cerrar"))},"Cerrar")])])}}}),$s=k(Es,[["__scopeId","data-v-0378c6b2"]]),Rs={class:"modal-overlay"},Ls={class:"modal-content"},Ts={style:{"margin-top":"1rem"}},qs=A({__name:"CambiarEstadoModal",props:{pedidoId:{},estadoActual:{}},emits:["cerrar","estadoActualizado"],setup(i,{emit:e}){const t=new F("https://database-mvp-production.up.railway.app"),s=i,n=e,o=v(s.estadoActual),r=async()=>{try{await t.collection("orders").update(s.pedidoId,{estado:o.value}),n("estadoActualizado",o.value),n("cerrar")}catch(a){console.error("❌ Error actualizando estado:",a)}};return(a,l)=>(p(),f("div",Rs,[c("div",Ls,[l[3]||(l[3]=c("h3",null,"Cambiar estado del pedido",-1)),L(c("select",{"onUpdate:modelValue":l[0]||(l[0]=u=>o.value=u),class:"select-estado"},l[2]||(l[2]=[c("option",{value:"PENDIENTE"},"PENDIENTE",-1),c("option",{value:"PROCESANDO"},"PROCESANDO",-1),c("option",{value:"COMPLETADO"},"COMPLETADO",-1)]),512),[[Se,o.value]]),c("div",Ts,[c("button",{class:"btn-guardar",onClick:r},"Guardar"),c("button",{class:"btn-cerrar",onClick:l[1]||(l[1]=u=>a.$emit("cerrar"))},"Cancelar")])])]))}}),Us=k(qs,[["__scopeId","data-v-2b916b93"]]),Ns={class:"pedidos-container"},xs={class:"pedidos-header"},js={class:"badge estado-pendiente"},Ds={class:"badge estado-procesando"},Fs={class:"badge estado-completado"},Bs={class:"pedidos-list"},Ms={class:"pedido-info"},Vs={class:"pedido-id"},Ws={class:"pedido-cliente"},zs={class:"pedido-fecha"},Ks={class:"pedido-estado estado-pendiente"},Gs={class:"pedido-acciones"},Js=["onClick"],Hs=["onClick"],Qs=A({__name:"PedidosPendientes",setup(i){const e=new F("https://database-mvp-production.up.railway.app"),t=B(),s=v([]),n=v(!1),o=v(!1),r=v(null),a=v(null),l=M(()=>s.value.filter(m=>m.estado==="pendiente")),u=M(()=>s.value.filter(m=>m.estado==="preparado")),b=M(()=>s.value.filter(m=>m.estado==="entregado")),d=m=>new Date(m).toLocaleDateString("es-CL",{day:"2-digit",month:"2-digit",year:"numeric"}),h=m=>{r.value=m,n.value=!0},_=m=>{a.value=m,o.value=!0},g=m=>{if(!a.value)return;const w=s.value.findIndex(C=>{var O;return C.id===((O=a.value)==null?void 0:O.id)});w!==-1&&(s.value[w].estado=m)},S=async m=>{const C=(await e.collection("productos_pedido").getFullList({filter:`pedido_id="${m.id}"`})).map(O=>({producto:O.nombre_producto,cantidad:O.cantidad,dosis:O.dosis,observaciones:O.observaciones,requiereReceta:O.requiereReceta??!1}));return{id:m.id,cliente:m.nombre_cliente,fecha:m.created,items:C,estado:m.estado||"pendiente"}},I=async()=>{try{if(!t.sucursalId)return;const m=await e.collection("pedidos").getFullList({sort:"-created",filter:`sucursal_id="${t.sucursalId}"`});s.value=await Promise.all(m.map(w=>S(w)))}catch(m){console.error("❌ Error al cargar pedidos:",m)}},q=()=>{t.sucursalId&&e.collection("pedidos").subscribe("*",async m=>{if(m.record.sucursal_id!==t.sucursalId)return;console.log("📦 Realtime evento:",m.action,m.record);const w=await S(m.record),C=s.value.findIndex(O=>O.id===w.id);switch(m.action){case"create":s.value.unshift(w);break;case"update":C!==-1?s.value.splice(C,1,w):s.value.unshift(w);break;case"delete":C!==-1&&s.value.splice(C,1);break}})},x=()=>{e.collection("pedidos").unsubscribe("*")};return N(async()=>{await t.checkAuth(),await I(),q()}),te(()=>{x()}),(m,w)=>(p(),f(D,null,[w[4]||(w[4]=c("h1",null,"Pedidos Pendientes",-1)),c("div",Ns,[c("div",xs,[c("span",js,y(l.value.length)+" Pendientes",1),c("span",Ds,y(u.value.length)+" Procesando",1),c("span",Fs,y(b.value.length)+" Completados",1)]),c("div",Bs,[(p(!0),f(D,null,J(s.value,C=>(p(),f("div",{key:C.id,class:"pedido-card"},[c("div",Ms,[c("span",Vs,"#"+y(C.id),1),c("span",Ws,y(C.cliente),1),c("span",zs,y(d(C.fecha)),1)]),c("div",Ks,y(C.estado),1),c("div",Gs,[c("button",{class:"btn-detalle",onClick:O=>h(C)},w[2]||(w[2]=[c("i",{class:"fas fa-eye"},null,-1),c("span",{class:"btn-text"},"Ver",-1)]),8,Js),c("button",{class:"btn-detalle",onClick:O=>_(C)},w[3]||(w[3]=[c("i",{class:"fas fa-sync-alt"},null,-1),c("span",{class:"btn-text"},"Cambiar estado",-1)]),8,Hs)])]))),128))])]),n.value?(p(),Q($s,{key:0,pedido:r.value,onCerrar:w[0]||(w[0]=C=>n.value=!1)},null,8,["pedido"])):$("",!0),o.value&&a.value?(p(),Q(Us,{key:1,"pedido-id":a.value.id,"estado-actual":a.value.estado,onCerrar:w[1]||(w[1]=C=>o.value=!1),onEstadoActualizado:g},null,8,["pedido-id","estado-actual"])):$("",!0)],64))}}),Ys=k(Qs,[["__scopeId","data-v-4b5cba5e"]]),Zs={class:"sucursal-admin"},Xs={class:"sucursal-lista"},en=["onClick"],ve="tu-farmacia-id-aqui",tn=A({__name:"SucursalesAdmin",setup(i){const e=new F("https://database-mvp-production.up.railway.app"),t=v([]),s=v(""),n=async()=>{t.value=await e.collection("sucursales").getFullList({filter:`farmacia_id="${ve}"`,sort:"-fecha_creacion"})},o=async()=>{await e.collection("sucursales").create({direccion:s.value,farmacia_id:ve}),s.value="",await n()},r=async a=>{await e.collection("sucursales").delete(a),await n()};return N(()=>{n()}),(a,l)=>(p(),f("div",Zs,[l[2]||(l[2]=c("h2",null,"Gestión de Sucursales",-1)),c("form",{onSubmit:P(o,["prevent"]),class:"sucursal-form"},[L(c("input",{"onUpdate:modelValue":l[0]||(l[0]=u=>s.value=u),placeholder:"Dirección de la sucursal",required:""},null,512),[[V,s.value]]),l[1]||(l[1]=c("button",{type:"submit"},"Agregar",-1))],32),c("ul",Xs,[(p(!0),f(D,null,J(t.value,u=>(p(),f("li",{key:u.id,class:"sucursal-item"},[j(y(u.direccion)+" ",1),c("button",{onClick:b=>r(u.id)},"Eliminar",8,en)]))),128))])]))}}),sn=k(tn,[["__scopeId","data-v-598fa4b7"]]),nn={class:"usuarios-admin"},on={class:"usuario-lista"},rn=["onClick"],ye="tu-sucursal-id-aqui",an=A({__name:"UsuariosAdmin",setup(i){const e=new F("https://database-mvp-production.up.railway.app"),t=v([]),s=v(""),n=v(""),o=v(""),r=v("admin"),a=async()=>{t.value=await e.collection("usuarios").getFullList({filter:`sucursal_id="${ye}"`,sort:"-fecha_creacion"})},l=async()=>{await e.collection("usuarios").create({nombre:s.value,email:n.value,password:o.value,rol:r.value,sucursal_id:ye}),s.value="",n.value="",o.value="",r.value="admin",await a()},u=async b=>{await e.collection("usuarios").delete(b),await a()};return N(()=>{a()}),(b,d)=>(p(),f("div",nn,[d[6]||(d[6]=c("h2",null,"Gestión de Usuarios",-1)),c("form",{onSubmit:P(l,["prevent"]),class:"usuario-form"},[L(c("input",{"onUpdate:modelValue":d[0]||(d[0]=h=>s.value=h),placeholder:"Nombre",required:""},null,512),[[V,s.value]]),L(c("input",{"onUpdate:modelValue":d[1]||(d[1]=h=>n.value=h),placeholder:"Email",type:"email",required:""},null,512),[[V,n.value]]),L(c("select",{"onUpdate:modelValue":d[2]||(d[2]=h=>r.value=h)},d[4]||(d[4]=[c("option",{value:"admin"},"Admin",-1),c("option",{value:"operador"},"Operador",-1)]),512),[[Se,r.value]]),L(c("input",{"onUpdate:modelValue":d[3]||(d[3]=h=>o.value=h),placeholder:"Contraseña",type:"password",required:""},null,512),[[V,o.value]]),d[5]||(d[5]=c("button",{type:"submit"},"Agregar",-1))],32),c("ul",on,[(p(!0),f(D,null,J(t.value,h=>(p(),f("li",{key:h.id,class:"usuario-item"},[j(y(h.nombre)+" - "+y(h.email)+" - "+y(h.rol)+" ",1),c("button",{onClick:_=>u(h.id)},"Eliminar",8,rn)]))),128))])]))}}),cn=k(an,[["__scopeId","data-v-71b12664"]]),ln={class:"qr-container"},un={class:"qr-header"},dn={class:"status-container"},hn={key:0,class:"telefono-label"},pn={key:1,class:"telefono-label"},fn={key:0,class:"loading-state"},mn={key:1,class:"error-state"},bn={class:"error-message"},gn={key:2,class:"qr-content"},vn=["src"],yn={key:3,class:"no-qr-state"},wn={key:0},Sn={key:1},_n={key:2},Cn=A({__name:"QrConfig",setup(i){const e=new F("https://database-mvp-production.up.railway.app"),t=B(),s=v(""),n=v("desconectado"),o=v(""),r=v(!1),a=v(null),l=M(()=>({esperando:"Esperando escaneo",listo:"Conectado",desconectado:"Desconectado",reconectando:"Reconectando"})[n.value.toLowerCase()]||n.value),u=d=>{d!=null&&d.qr_code?s.value=e.files.getUrl(d,d.qr_code,{thumb:"300x300"}):s.value="",n.value=(d==null?void 0:d.estado)||"desconectado",o.value=(d==null?void 0:d.telefono)||""},b=async()=>{var d;try{const h=(d=t.user)==null?void 0:d.sucursal_id;if(!h)throw new Error("No se ha proporcionado un ID de sucursal válido");r.value=!0,a.value=null;const _=await e.collection("vinculos_sucursal").getFirstListItem(`sucursal_id="${h}"`,{expand:"sucursal_id"});u(_)}catch(h){console.error("❌ Error al cargar vínculo:",h),a.value=(h==null?void 0:h.status)===404?"No se encontró la configuración de WhatsApp para esta sucursal":"Error al cargar la configuración de WhatsApp",s.value="",n.value="desconectado",o.value=""}finally{r.value=!1}};return N(b),(d,h)=>(p(),f("div",ln,[c("div",un,[h[0]||(h[0]=c("h2",{class:"text-header"},"Conexión WhatsApp",-1)),c("div",dn,[c("span",{class:G(["estado-label","estado-"+n.value.toLowerCase()])},y(l.value),3),o.value?(p(),f("span",hn,"Teléfono: "+y(o.value),1)):(p(),f("span",pn,"Teléfono: No asignado"))])]),r.value?(p(),f("div",fn,h[1]||(h[1]=[c("div",{class:"spinner"},null,-1),c("p",null,"Cargando configuración de WhatsApp...",-1)]))):a.value?(p(),f("div",mn,[h[2]||(h[2]=c("svg",{class:"error-icon",viewBox:"0 0 24 24"},[c("path",{fill:"currentColor",d:"M12,2C17.53,2 22,6.47 22,12C22,17.53 17.53,22 12,22C6.47,22 2,17.53 2,12C2,6.47 6.47,2 12,2M15.59,7L12,10.59L8.41,7L7,8.41L10.59,12L7,15.59L8.41,17L12,13.41L15.59,17L17,15.59L13.41,12L17,8.41L15.59,7Z"})],-1)),c("p",bn,y(a.value),1),c("button",{onClick:b,class:"retry-button"},"Reintentar")])):s.value?(p(),f("div",gn,[c("img",{src:s.value,alt:"Código QR de WhatsApp",class:"qr-image"},null,8,vn),h[3]||(h[3]=c("p",{class:"qr-instructions"}," Escanea este código con WhatsApp en tu teléfono para vincular la sucursal ",-1))])):(p(),f("div",yn,[h[4]||(h[4]=c("svg",{class:"no-qr-icon",viewBox:"0 0 24 24"},[c("path",{fill:"currentColor",d:"M12,2A10,10 0 0,1 22,12A10,10 0 0,1 12,22A10,10 0 0,1 2,12A10,10 0 0,1 12,2M12,4A8,8 0 0,0 4,12A8,8 0 0,0 12,20A8,8 0 0,0 20,12A8,8 0 0,0 12,4Z"})],-1)),n.value==="listo"?(p(),f("p",wn,"✅ Conexión establecida correctamente")):n.value==="desconectado"?(p(),f("p",Sn,"🔴 No hay conexión activa")):(p(),f("p",_n,"Esperando código QR para vincular..."))]))]))}}),On=k(Cn,[["__scopeId","data-v-d4c30485"]]),kn={class:"dashboard-view"},In={class:"content-container"},An=A({__name:"DashboardView",setup(i){const e=v(!0),t=v("dashboard"),s=v(!1),n={dashboard:ge,pedidos:Ys,sucursales:sn,usuarios:cn,configuracion:On},o=M(()=>n[t.value]||ge),r=()=>{s.value=window.innerWidth<768,e.value=!s.value},a=()=>{e.value=!e.value};return N(()=>{window.addEventListener("resize",r),r()}),te(()=>{window.removeEventListener("resize",r)}),(l,u)=>(p(),f("div",kn,[R(cs,{onToggleSidebar:a}),R(gs,{visible:e.value,"onUpdate:visible":u[0]||(u[0]=b=>e.value=b),"current-section":t.value,"onUpdate:currentSection":u[1]||(u[1]=b=>t.value=b)},null,8,["visible","current-section"]),c("div",{class:G(["main-content",{collapsed:!e.value&&!s.value}])},[c("div",In,[(p(),Q(je(o.value)))])],2)]))}}),Pn=k(An,[["__scopeId","data-v-06b1ded1"]]),En="/assets/LogoMediBot-Du84vOzi.png",$n={class:"login-page"},Rn={class:"login-section"},Ln={class:"login-container"},Tn=["disabled"],qn={key:0,class:"error-message"},Un=A({__name:"loginSection",setup(i){const e=we(),t=B(),s=v(""),n=v(""),o=async()=>{await t.login(s.value,n.value)&&e.push("/dashboard")};return(r,a)=>(p(),f("div",$n,[R($e),c("section",Rn,[c("div",Ln,[a[2]||(a[2]=c("img",{src:En,alt:"Logo MediBot",class:"login-logo"},null,-1)),a[3]||(a[3]=c("h2",{class:"login-title"},"Iniciar sesión",-1)),c("form",{class:"login-form",onSubmit:P(o,["prevent"])},[L(c("input",{"onUpdate:modelValue":a[0]||(a[0]=l=>s.value=l),type:"email",placeholder:"Correo electrónico",required:""},null,512),[[V,s.value]]),L(c("input",{"onUpdate:modelValue":a[1]||(a[1]=l=>n.value=l),type:"password",placeholder:"Contraseña",required:""},null,512),[[V,n.value]]),c("button",{type:"submit",disabled:K(t).loading},y(K(t).loading?"Cargando...":"Entrar"),9,Tn)],32),K(t).error?(p(),f("p",qn,y(K(t).error),1)):$("",!0),a[4]||(a[4]=c("p",{class:"login-note"},"¿No tienes cuenta? Contáctanos para activarla.",-1))])]),R(Re)]))}}),Nn=k(Un,[["__scopeId","data-v-b122b2a4"]]),Le=De({history:Fe("/"),routes:[{path:"/",name:"home",component:ns,meta:{public:!0}},{path:"/dashboard",name:"dashboard",component:Pn,meta:{requiresAuth:!0}},{path:"/login",name:"login",component:Nn,meta:{public:!0}}]});Le.beforeEach(async(i,e,t)=>{const s=(await kt(async()=>{const{useAuthStore:n}=await Promise.resolve().then(()=>wt);return{useAuthStore:n}},void 0)).useAuthStore();await s.checkAuth(),i.meta.requiresAuth&&!s.isAuthenticated?t("/login"):t()});const Te=Be();Te.use(Ze);const oe=Me(_t);oe.use(Te);oe.use(Le);oe.mount("#app");
